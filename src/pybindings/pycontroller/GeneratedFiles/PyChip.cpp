#include <functional>
#include <map>
#include <memory>
#include <stdexcept>
#include <string>

#include <pybind11/pybind11.h>

typedef std::function<pybind11::module &(std::string const &)> ModuleGetter;

void bind_PyChip_0(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_1(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_2(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_3(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_4(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_5(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_6(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_7(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_8(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_9(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_10(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_11(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_12(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_13(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_14(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_15(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_16(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_17(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_18(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_19(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_20(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_21(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_22(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_23(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_24(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_25(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_26(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_27(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_28(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_29(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_30(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_31(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_32(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_33(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_34(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_35(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_36(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_37(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_38(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_39(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_40(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_41(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_42(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_43(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_44(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_45(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_46(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_47(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_48(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_49(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_50(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_51(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_52(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_53(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_54(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_55(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_56(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_57(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_58(std::function<pybind11::module &(std::string const & namespace_)> & M);
void bind_PyChip_59(std::function<pybind11::module &(std::string const & namespace_)> & M);

PYBIND11_MODULE(PyChip, root_module)
{
    root_module.doc() = "PyChip module";

    std::map<std::string, pybind11::module> modules;
    ModuleGetter M = [&](std::string const & namespace_) -> pybind11::module & {
        auto it = modules.find(namespace_);
        if (it == modules.end())
            throw std::runtime_error("Attempt to access pybind11::module for namespace " + namespace_ +
                                     " before it was created!!!");
        return it->second;
    };

    modules[""] = root_module;

    std::vector<std::pair<std::string, std::string>> sub_modules{
        { "", "chip" },
        { "chip", "Ble" },
        { "chip", "Callback" },
        { "chip", "DeviceLayer" },
        { "chip::DeviceLayer", "DeviceEventType" },
        { "chip::DeviceLayer", "Internal" },
        { "chip", "Encoding" },
        { "chip::Encoding", "BigEndian" },
        { "chip::Encoding", "LittleEndian" },
        { "chip", "Inet" },
        { "chip::Inet", "Platform" },
        { "chip::Inet::Platform", "InetLayer" },
        { "chip", "Logging" },
        { "chip", "Platform" },
        { "chip::Platform", "PersistedStorage" },
        { "chip", "System" },
        { "chip::System", "Platform" },
        { "chip::System::Platform", "Layer" },
        { "chip::System", "Stats" },
        { "chip", "TLV" },
    };
    for (auto & p : sub_modules)
        modules[p.first.size() ? p.first + "::" + p.second : p.second] =
            modules[p.first].def_submodule(p.second.c_str(), ("Bindings for " + p.first + "::" + p.second + " namespace").c_str());

    // pybind11::class_<std::shared_ptr<void>>(M(""), "_encapsulated_data_");

    bind_PyChip_0(M);
    bind_PyChip_1(M);
    bind_PyChip_2(M);
    bind_PyChip_3(M);
    bind_PyChip_4(M);
    bind_PyChip_5(M);
    bind_PyChip_6(M);
    bind_PyChip_7(M);
    bind_PyChip_8(M);
    bind_PyChip_9(M);
    bind_PyChip_10(M);
    bind_PyChip_11(M);
    bind_PyChip_12(M);
    bind_PyChip_13(M);
    bind_PyChip_14(M);
    bind_PyChip_15(M);
    bind_PyChip_16(M);
    bind_PyChip_17(M);
    bind_PyChip_18(M);
    bind_PyChip_19(M);
    bind_PyChip_20(M);
    bind_PyChip_21(M);
    bind_PyChip_22(M);
    bind_PyChip_23(M);
    bind_PyChip_24(M);
    bind_PyChip_25(M);
    bind_PyChip_26(M);
    bind_PyChip_27(M);
    bind_PyChip_28(M);
    bind_PyChip_29(M);
    bind_PyChip_30(M);
    bind_PyChip_31(M);
    bind_PyChip_32(M);
    bind_PyChip_33(M);
    bind_PyChip_34(M);
    bind_PyChip_35(M);
    bind_PyChip_36(M);
    bind_PyChip_37(M);
    bind_PyChip_38(M);
    bind_PyChip_39(M);
    bind_PyChip_40(M);
    bind_PyChip_41(M);
    bind_PyChip_42(M);
    bind_PyChip_43(M);
    bind_PyChip_44(M);
    bind_PyChip_45(M);
    bind_PyChip_46(M);
    bind_PyChip_47(M);
    bind_PyChip_48(M);
    bind_PyChip_49(M);
    bind_PyChip_50(M);
    bind_PyChip_51(M);
    bind_PyChip_52(M);
    bind_PyChip_53(M);
    bind_PyChip_54(M);
    bind_PyChip_55(M);
    bind_PyChip_56(M);
    bind_PyChip_57(M);
    bind_PyChip_58(M);
    bind_PyChip_59(M);
}
